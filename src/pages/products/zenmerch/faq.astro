---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import { groq, sanityClient } from "../../../lib/sanity";

const fallbackFaqs = [
  {
    q: "Is ZenMerch a Shopify app?",
    a: "Yes. ZenMerch is designed as a Shopify app and is built to keep key information publicly accessible (pricing, docs, legal, contact).",
  },
  {
    q: "Does ZenMerch support theme extensions / OS2?",
    a: "ZenMerch is built with a theme-extension approach in mind for modern Shopify themes. See the docs for setup guidance.",
  },
  {
    q: "Can I charge extra for customizations?",
    a: "Yes—ZenMerch supports dynamic pricing patterns so you can charge for premium options.",
  },
  {
    q: "How do uploads work?",
    a: "Customers can upload assets (with validations). ZenMerch is designed to pass clean order data and assets into fulfillment workflows.",
  },
  {
    q: "How do I get support?",
    a: "Use the contact form on zenovee.com/contact or email support (listed in the footer).",
  },
];

type CmsFaq = { q: string; a: string };
let cmsFaqs: CmsFaq[] | null = null;
if (sanityClient) {
  cmsFaqs = await sanityClient.fetch(
    groq`*[_type=="faqItem" && (!defined(product) || product->slug.current=="zenmerch")] | order(_createdAt asc) {
      "q": question,
      "a": pt::text(answer)
    }`,
  );
}

const faqs =
  cmsFaqs && Array.isArray(cmsFaqs) && cmsFaqs.length > 0
    ? cmsFaqs
    : fallbackFaqs;
---

<BaseLayout title="ZenMerch FAQ" description="Frequently asked questions about ZenMerch, the Shopify product personalization app.">
  <section class="container-pad py-14 sm:py-20">
    <div class="reveal" data-reveal>
      <h1 class="text-4xl font-semibold tracking-tight sm:text-5xl">ZenMerch FAQ</h1>
      <p class="mt-4 max-w-2xl text-white/70">
        Quick answers for merchants and Shopify reviewers. If you don’t see your question, contact us.
      </p>
      <div class="mt-7 flex flex-col gap-3 sm:flex-row">
        <a class="btn btn-primary" href="/contact">Contact</a>
        <a class="btn btn-secondary" href="/products/zenmerch/docs">Docs</a>
        <a class="btn btn-secondary" href="/products/zenmerch/pricing">Pricing</a>
      </div>
    </div>

    <div class="mt-10 grid gap-3">
      {faqs.map((f) => (
        <details class="card reveal p-5" data-reveal>
          <summary class="cursor-pointer text-sm font-semibold">{f.q}</summary>
          <p class="mt-3 text-sm text-white/65">{f.a}</p>
        </details>
      ))}
    </div>
  </section>
</BaseLayout>

